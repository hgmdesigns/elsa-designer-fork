import{e as t,U as n,M as r,R as e,l as i,a as s}from"./p-29c91123.js";import"./p-94a66dfc.js";import"./p-2484a96d.js";import"./p-25c0eb4f.js";import"./p-665c8054.js";import"./p-b514879f.js";import"./p-884c4b95.js";import"./p-c4caec5c.js";import"./p-db67fce4.js";import"./p-4e7f4a74.js";import"./p-04dc1c4d.js";import"./p-fd4270fe.js";import"./p-4bedee02.js";import"./p-2865f18e.js";import"./p-83f217d4.js";import"./p-dfca8bd9.js";var u,o,c=function(){function n(t,n){var r=this;this._modeId=t,this._defaults=n,this._worker=null,this._client=null,this._configChangeListener=this._defaults.onDidChange((function(){return r._stopWorker()})),this._updateExtraLibsToken=0,this._extraLibsChangeListener=this._defaults.onDidExtraLibsChange((function(){return r._updateExtraLibs()}))}return n.prototype._stopWorker=function(){this._worker&&(this._worker.dispose(),this._worker=null),this._client=null},n.prototype.dispose=function(){this._configChangeListener.dispose(),this._extraLibsChangeListener.dispose(),this._stopWorker()},n.prototype._updateExtraLibs=function(){return t=this,n=void 0,e=function(){var t,n;return function(t,n){var r,e,i,s,u={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function o(s){return function(o){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;u;)try{if(r=1,e&&(i=2&s[0]?e.return:s[0]?e.throw||((i=e.return)&&i.call(e),0):e.next)&&!(i=i.call(e,s[1])).done)return i;switch(e=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return u.label++,{value:s[1],done:!1};case 5:u.label++,e=s[1],s=[0];continue;case 7:s=u.ops.pop(),u.trys.pop();continue;default:if(!((i=(i=u.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){u=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){u.label=s[1];break}if(6===s[0]&&u.label<i[1]){u.label=i[1],i=s;break}if(i&&u.label<i[2]){u.label=i[2],u.ops.push(s);break}i[2]&&u.ops.pop(),u.trys.pop();continue}s=n.call(t,u)}catch(t){s=[6,t],e=0}finally{r=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,o])}}}(this,(function(r){switch(r.label){case 0:return this._worker?(t=++this._updateExtraLibsToken,[4,this._worker.getProxy()]):[2];case 1:return n=r.sent(),this._updateExtraLibsToken!==t||n.updateExtraLibs(this._defaults.getExtraLibs()),[2]}}))},new((r=void 0)||(r=Promise))((function(i,s){function u(t){try{c(e.next(t))}catch(t){s(t)}}function o(t){try{c(e.throw(t))}catch(t){s(t)}}function c(t){var n;t.done?i(t.value):(n=t.value,n instanceof r?n:new r((function(t){t(n)}))).then(u,o)}c((e=e.apply(t,n||[])).next())}));var t,n,r,e},n.prototype._getClient=function(){var n=this;if(!this._client){this._worker=t.createWebWorker({moduleId:"vs/language/typescript/tsWorker",label:this._modeId,keepIdleModels:!0,createData:{compilerOptions:this._defaults.getCompilerOptions(),extraLibs:this._defaults.getExtraLibs(),customWorkerPath:this._defaults.workerOptions.customWorkerPath}});var r=this._worker.getProxy();this._defaults.getEagerModelSync()&&(r=r.then((function(r){return n._worker?n._worker.withSyncedResources(t.getModels().filter((function(t){return t.getModeId()===n._modeId})).map((function(t){return t.uri}))):r}))),this._client=r}return this._client},n.prototype.getLanguageServiceWorker=function(){for(var t,n=this,r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];return this._getClient().then((function(n){t=n})).then((function(){if(n._worker)return n._worker.withSyncedResources(r)})).then((function(){return t}))},n}(),a={"lib.d.ts":!0,"lib.dom.d.ts":!0,"lib.dom.iterable.d.ts":!0,"lib.es2015.collection.d.ts":!0,"lib.es2015.core.d.ts":!0,"lib.es2015.d.ts":!0,"lib.es2015.generator.d.ts":!0,"lib.es2015.iterable.d.ts":!0,"lib.es2015.promise.d.ts":!0,"lib.es2015.proxy.d.ts":!0,"lib.es2015.reflect.d.ts":!0,"lib.es2015.symbol.d.ts":!0,"lib.es2015.symbol.wellknown.d.ts":!0,"lib.es2016.array.include.d.ts":!0,"lib.es2016.d.ts":!0,"lib.es2016.full.d.ts":!0,"lib.es2017.d.ts":!0,"lib.es2017.full.d.ts":!0,"lib.es2017.intl.d.ts":!0,"lib.es2017.object.d.ts":!0,"lib.es2017.sharedmemory.d.ts":!0,"lib.es2017.string.d.ts":!0,"lib.es2017.typedarrays.d.ts":!0,"lib.es2018.asyncgenerator.d.ts":!0,"lib.es2018.asynciterable.d.ts":!0,"lib.es2018.d.ts":!0,"lib.es2018.full.d.ts":!0,"lib.es2018.intl.d.ts":!0,"lib.es2018.promise.d.ts":!0,"lib.es2018.regexp.d.ts":!0,"lib.es2019.array.d.ts":!0,"lib.es2019.d.ts":!0,"lib.es2019.full.d.ts":!0,"lib.es2019.object.d.ts":!0,"lib.es2019.string.d.ts":!0,"lib.es2019.symbol.d.ts":!0,"lib.es2020.bigint.d.ts":!0,"lib.es2020.d.ts":!0,"lib.es2020.full.d.ts":!0,"lib.es2020.intl.d.ts":!0,"lib.es2020.promise.d.ts":!0,"lib.es2020.sharedmemory.d.ts":!0,"lib.es2020.string.d.ts":!0,"lib.es2020.symbol.wellknown.d.ts":!0,"lib.es5.d.ts":!0,"lib.es6.d.ts":!0,"lib.esnext.d.ts":!0,"lib.esnext.full.d.ts":!0,"lib.esnext.intl.d.ts":!0,"lib.esnext.promise.d.ts":!0,"lib.esnext.string.d.ts":!0,"lib.esnext.weakref.d.ts":!0,"lib.scripthost.d.ts":!0,"lib.webworker.d.ts":!0,"lib.webworker.importscripts.d.ts":!0,"lib.webworker.iterable.d.ts":!0},f=(u=function(t,n){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])})(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}u(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}),l=function(t,n,r,e){return new(r||(r=Promise))((function(i,s){function u(t){try{c(e.next(t))}catch(t){s(t)}}function o(t){try{c(e.throw(t))}catch(t){s(t)}}function c(t){var n;t.done?i(t.value):(n=t.value,n instanceof r?n:new r((function(t){t(n)}))).then(u,o)}c((e=e.apply(t,n||[])).next())}))},h=function(t,n){var r,e,i,s,u={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function o(s){return function(o){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;u;)try{if(r=1,e&&(i=2&s[0]?e.return:s[0]?e.throw||((i=e.return)&&i.call(e),0):e.next)&&!(i=i.call(e,s[1])).done)return i;switch(e=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return u.label++,{value:s[1],done:!1};case 5:u.label++,e=s[1],s=[0];continue;case 7:s=u.ops.pop(),u.trys.pop();continue;default:if(!((i=(i=u.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){u=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){u.label=s[1];break}if(6===s[0]&&u.label<i[1]){u.label=i[1],i=s;break}if(i&&u.label<i[2]){u.label=i[2],u.ops.push(s);break}i[2]&&u.ops.pop(),u.trys.pop();continue}s=n.call(t,u)}catch(t){s=[6,t],e=0}finally{r=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,o])}}};function d(t,n,r){if(void 0===r&&(r=0),"string"==typeof t)return t;if(void 0===t)return"";var e="";if(r){e+=n;for(var i=0;i<r;i++)e+="  "}if(e+=t.messageText,r++,t.next)for(var s=0,u=t.next;s<u.length;s++)e+=d(u[s],n,r);return e}function v(t){return t?t.map((function(t){return t.text})).join(""):""}!function(t){t[t.None=0]="None",t[t.Block=1]="Block",t[t.Smart=2]="Smart"}(o||(o={}));var b,p=function(){function t(t){this._worker=t}return t.prototype._textSpanToRange=function(t,n){var r=t.getPositionAt(n.start),e=t.getPositionAt(n.start+n.length);return{startLineNumber:r.lineNumber,startColumn:r.column,endLineNumber:e.lineNumber,endColumn:e.column}},t}(),m=function(){function n(t){this._worker=t,this._libFiles={},this._hasFetchedLibFiles=!1,this._fetchLibFilesPromise=null}return n.prototype.isLibFile=function(t){return!!t&&0===t.path.indexOf("/lib.")&&!!a[t.path.slice(1)]},n.prototype.getOrCreateModel=function(n){return t.getModel(n)||(this.isLibFile(n)&&this._hasFetchedLibFiles?t.createModel(this._libFiles[n.path.slice(1)],"typescript",n):null)},n.prototype._containsLibFile=function(t){for(var n=0,r=t;n<r.length;n++)if(this.isLibFile(r[n]))return!0;return!1},n.prototype.fetchLibFilesIfNecessary=function(t){return l(this,void 0,void 0,(function(){return h(this,(function(n){switch(n.label){case 0:return this._containsLibFile(t)?[4,this._fetchLibFiles()]:[2];case 1:return n.sent(),[2]}}))}))},n.prototype._fetchLibFiles=function(){var t=this;return this._fetchLibFilesPromise||(this._fetchLibFilesPromise=this._worker().then((function(t){return t.getLibFiles()})).then((function(n){t._hasFetchedLibFiles=!0,t._libFiles=n}))),this._fetchLibFilesPromise},n}();!function(t){t[t.Warning=0]="Warning",t[t.Error=1]="Error",t[t.Suggestion=2]="Suggestion",t[t.Message=3]="Message"}(b||(b={}));var w=function(e){function i(n,r,i,s){var u=e.call(this,s)||this;u._libFiles=n,u._defaults=r,u._selector=i,u._disposables=[],u._listener=Object.create(null);var o=function(t){if(t.getModeId()===i){var n,r=t.onDidChangeContent((function(){clearTimeout(n),n=setTimeout((function(){return u._doValidate(t)}),500)}));u._listener[t.uri.toString()]={dispose:function(){r.dispose(),clearTimeout(n)}},u._doValidate(t)}},c=function(n){t.setModelMarkers(n,u._selector,[]);var r=n.uri.toString();u._listener[r]&&(u._listener[r].dispose(),delete u._listener[r])};u._disposables.push(t.onDidCreateModel(o)),u._disposables.push(t.onWillDisposeModel(c)),u._disposables.push(t.onDidChangeModelLanguage((function(t){c(t.model),o(t.model)}))),u._disposables.push({dispose:function(){for(var n=0,r=t.getModels();n<r.length;n++)c(r[n])}});var a=function(){for(var n=0,r=t.getModels();n<r.length;n++){var e=r[n];c(e),o(e)}};return u._disposables.push(u._defaults.onDidChange(a)),u._disposables.push(u._defaults.onDidExtraLibsChange(a)),t.getModels().forEach(o),u}return f(i,e),i.prototype.dispose=function(){this._disposables.forEach((function(t){return t&&t.dispose()})),this._disposables=[]},i.prototype._doValidate=function(r){return l(this,void 0,void 0,(function(){var e,i,s,u,o,c,a,f,l=this;return h(this,(function(h){switch(h.label){case 0:return[4,this._worker(r.uri)];case 1:return e=h.sent(),r.isDisposed()?[2]:(i=[],s=this._defaults.getDiagnosticsOptions(),u=s.noSemanticValidation,o=s.noSuggestionDiagnostics,s.noSyntaxValidation||i.push(e.getSyntacticDiagnostics(r.uri.toString())),u||i.push(e.getSemanticDiagnostics(r.uri.toString())),o||i.push(e.getSuggestionDiagnostics(r.uri.toString())),[4,Promise.all(i)]);case 2:return!(c=h.sent())||r.isDisposed()?[2]:(a=c.reduce((function(t,n){return n.concat(t)}),[]).filter((function(t){return-1===(l._defaults.getDiagnosticsOptions().diagnosticCodesToIgnore||[]).indexOf(t.code)})),f=a.map((function(t){return t.relatedInformation||[]})).reduce((function(t,n){return n.concat(t)}),[]).map((function(t){return t.file?n.parse(t.file.fileName):null})),[4,this._libFiles.fetchLibFilesIfNecessary(f)]);case 3:return h.sent(),r.isDisposed()||t.setModelMarkers(r,this._selector,a.map((function(t){return l._convertDiagnostics(r,t)}))),[2]}}))}))},i.prototype._convertDiagnostics=function(t,n){var r=n.start||0,e=n.length||1,i=t.getPositionAt(r),u=i.lineNumber,o=i.column,c=t.getPositionAt(r+e),a=c.lineNumber,f=c.column,l=[];return n.reportsUnnecessary&&l.push(s.Unnecessary),n.reportsDeprecated&&l.push(s.Deprecated),{severity:this._tsDiagnosticCategoryToMarkerSeverity(n.category),startLineNumber:u,startColumn:o,endLineNumber:a,endColumn:f,message:d(n.messageText,"\n"),code:n.code.toString(),tags:l,relatedInformation:this._convertRelatedInformation(t,n.relatedInformation)}},i.prototype._convertRelatedInformation=function(t,r){var e=this;if(r){var i=[];return r.forEach((function(r){var s=t;if(r.file){var u=n.parse(r.file.fileName);s=e._libFiles.getOrCreateModel(u)}if(s){var o=r.start||0,c=r.length||1,a=s.getPositionAt(o),f=a.lineNumber,l=a.column,h=s.getPositionAt(o+c);i.push({resource:s.uri,startLineNumber:f,startColumn:l,endLineNumber:h.lineNumber,endColumn:h.column,message:d(r.messageText,"\n")})}})),i}},i.prototype._tsDiagnosticCategoryToMarkerSeverity=function(t){switch(t){case b.Error:return r.Error;case b.Message:return r.Info;case b.Warning:return r.Warning;case b.Suggestion:return r.Hint}return r.Info},i}(p),g=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return f(n,t),Object.defineProperty(n.prototype,"triggerCharacters",{get:function(){return["."]},enumerable:!1,configurable:!0}),n.prototype.provideCompletionItems=function(t,r){return l(this,void 0,void 0,(function(){var s,u,o,c,a,f;return h(this,(function(l){switch(l.label){case 0:return s=t.getWordUntilPosition(r),u=new e(r.lineNumber,s.startColumn,r.lineNumber,s.endColumn),o=t.uri,c=t.getOffsetAt(r),[4,this._worker(o)];case 1:return a=l.sent(),t.isDisposed()?[2]:[4,a.getCompletionsAtPosition(o.toString(),c)];case 2:return!(f=l.sent())||t.isDisposed()?[2]:[2,{suggestions:f.entries.map((function(s){var a,f=u;if(s.replacementSpan){var l=t.getPositionAt(s.replacementSpan.start),h=t.getPositionAt(s.replacementSpan.start+s.replacementSpan.length);f=new e(l.lineNumber,l.column,h.lineNumber,h.column)}var d=[];return-1!==(null===(a=s.kindModifiers)||void 0===a?void 0:a.indexOf("deprecated"))&&d.push(i.CompletionItemTag.Deprecated),{uri:o,position:r,offset:c,range:f,label:s.name,insertText:s.name,sortText:s.sortText,kind:n.convertKind(s.kind),tags:d}}))}]}}))}))},n.prototype.resolveCompletionItem=function(t){return l(this,void 0,void 0,(function(){var r,e,i,s,u;return h(this,(function(o){switch(o.label){case 0:return i=(r=t).position,s=r.offset,[4,this._worker(e=r.uri)];case 1:return[4,o.sent().getCompletionEntryDetails(e.toString(),s,r.label)];case 2:return(u=o.sent())?[2,{uri:e,position:i,label:u.name,kind:n.convertKind(u.kind),detail:v(u.displayParts),documentation:{value:n.createDocumentationString(u)}}]:[2,r]}}))}))},n.convertKind=function(t){switch(t){case I.primitiveType:case I.keyword:return i.CompletionItemKind.Keyword;case I.variable:case I.localVariable:return i.CompletionItemKind.Variable;case I.memberVariable:case I.memberGetAccessor:case I.memberSetAccessor:return i.CompletionItemKind.Field;case I.function:case I.memberFunction:case I.constructSignature:case I.callSignature:case I.indexSignature:return i.CompletionItemKind.Function;case I.enum:return i.CompletionItemKind.Enum;case I.module:return i.CompletionItemKind.Module;case I.class:return i.CompletionItemKind.Class;case I.interface:return i.CompletionItemKind.Interface;case I.warning:return i.CompletionItemKind.File}return i.CompletionItemKind.Property},n.createDocumentationString=function(t){var n=v(t.documentation);if(t.tags)for(var r=0,e=t.tags;r<e.length;r++)n+="\n\n"+y(e[r]);return n},n}(p);function y(t){var n="*@"+t.name+"*";if("param"===t.name&&t.text){var r=t.text.split(" "),e=r[0],i=r.slice(1);n+="`"+e+"`",i.length>0&&(n+=" — "+i.join(" "))}else t.text&&(n+=" — "+t.text);return n}var k=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.signatureHelpTriggerCharacters=["(",","],n}return f(n,t),n._toSignatureHelpTriggerReason=function(t){switch(t.triggerKind){case i.SignatureHelpTriggerKind.TriggerCharacter:return t.triggerCharacter?t.isRetrigger?{kind:"retrigger",triggerCharacter:t.triggerCharacter}:{kind:"characterTyped",triggerCharacter:t.triggerCharacter}:{kind:"invoked"};case i.SignatureHelpTriggerKind.ContentChange:return t.isRetrigger?{kind:"retrigger"}:{kind:"invoked"};case i.SignatureHelpTriggerKind.Invoke:default:return{kind:"invoked"}}},n.prototype.provideSignatureHelp=function(t,r,e,i){return l(this,void 0,void 0,(function(){var e,s,u,o,c;return h(this,(function(a){switch(a.label){case 0:return e=t.uri,s=t.getOffsetAt(r),[4,this._worker(e)];case 1:return u=a.sent(),t.isDisposed()?[2]:[4,u.getSignatureHelpItems(e.toString(),s,{triggerReason:n._toSignatureHelpTriggerReason(i)})];case 2:return!(o=a.sent())||t.isDisposed()?[2]:(c={activeSignature:o.selectedItemIndex,activeParameter:o.argumentIndex,signatures:[]},o.items.forEach((function(t){var n={label:"",parameters:[]};n.documentation={value:v(t.documentation)},n.label+=v(t.prefixDisplayParts),t.parameters.forEach((function(r,e,i){var s=v(r.displayParts),u={label:s,documentation:{value:v(r.documentation)}};n.label+=s,n.parameters.push(u),e<i.length-1&&(n.label+=v(t.separatorDisplayParts))})),n.label+=v(t.suffixDisplayParts),c.signatures.push(n)})),[2,{value:c,dispose:function(){}}])}}))}))},n}(p),j=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return f(n,t),n.prototype.provideHover=function(t,n){return l(this,void 0,void 0,(function(){var r,e,i,s,u,o,c;return h(this,(function(a){switch(a.label){case 0:return r=t.uri,e=t.getOffsetAt(n),[4,this._worker(r)];case 1:return i=a.sent(),t.isDisposed()?[2]:[4,i.getQuickInfoAtPosition(r.toString(),e)];case 2:return!(s=a.sent())||t.isDisposed()?[2]:(u=v(s.documentation),o=s.tags?s.tags.map((function(t){return y(t)})).join("  \n\n"):"",c=v(s.displayParts),[2,{range:this._textSpanToRange(t,s.textSpan),contents:[{value:"```typescript\n"+c+"\n```\n"},{value:u+(o?"\n\n"+o:"")}]}])}}))}))},n}(p),S=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return f(n,t),n.prototype.provideDocumentHighlights=function(t,n){return l(this,void 0,void 0,(function(){var r,e,s,u,o=this;return h(this,(function(c){switch(c.label){case 0:return r=t.uri,e=t.getOffsetAt(n),[4,this._worker(r)];case 1:return s=c.sent(),t.isDisposed()?[2]:[4,s.getOccurrencesAtPosition(r.toString(),e)];case 2:return!(u=c.sent())||t.isDisposed()?[2]:[2,u.map((function(n){return{range:o._textSpanToRange(t,n.textSpan),kind:n.isWriteAccess?i.DocumentHighlightKind.Write:i.DocumentHighlightKind.Text}}))]}}))}))},n}(p),x=function(t){function r(n,r){var e=t.call(this,r)||this;return e._libFiles=n,e}return f(r,t),r.prototype.provideDefinition=function(t,r){return l(this,void 0,void 0,(function(){var e,i,s,u,o,c,a,f,l,d;return h(this,(function(h){switch(h.label){case 0:return e=t.uri,i=t.getOffsetAt(r),[4,this._worker(e)];case 1:return s=h.sent(),t.isDisposed()?[2]:[4,s.getDefinitionAtPosition(e.toString(),i)];case 2:return!(u=h.sent())||t.isDisposed()?[2]:[4,this._libFiles.fetchLibFilesIfNecessary(u.map((function(t){return n.parse(t.fileName)})))];case 3:if(h.sent(),t.isDisposed())return[2];for(o=[],c=0,a=u;c<a.length;c++)l=n.parse((f=a[c]).fileName),(d=this._libFiles.getOrCreateModel(l))&&o.push({uri:l,range:this._textSpanToRange(d,f.textSpan)});return[2,o]}}))}))},r}(p),C=function(t){function r(n,r){var e=t.call(this,r)||this;return e._libFiles=n,e}return f(r,t),r.prototype.provideReferences=function(t,r){return l(this,void 0,void 0,(function(){var e,i,s,u,o,c,a,f,l,d;return h(this,(function(h){switch(h.label){case 0:return e=t.uri,i=t.getOffsetAt(r),[4,this._worker(e)];case 1:return s=h.sent(),t.isDisposed()?[2]:[4,s.getReferencesAtPosition(e.toString(),i)];case 2:return!(u=h.sent())||t.isDisposed()?[2]:[4,this._libFiles.fetchLibFilesIfNecessary(u.map((function(t){return n.parse(t.fileName)})))];case 3:if(h.sent(),t.isDisposed())return[2];for(o=[],c=0,a=u;c<a.length;c++)l=n.parse((f=a[c]).fileName),(d=this._libFiles.getOrCreateModel(l))&&o.push({uri:l,range:this._textSpanToRange(d,f.textSpan)});return[2,o]}}))}))},r}(p),N=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return f(n,t),n.prototype.provideDocumentSymbols=function(t){return l(this,void 0,void 0,(function(){var n,r,e,s,u,o=this;return h(this,(function(c){switch(c.label){case 0:return[4,this._worker(n=t.uri)];case 1:return r=c.sent(),t.isDisposed()?[2]:[4,r.getNavigationBarItems(n.toString())];case 2:return!(e=c.sent())||t.isDisposed()?[2]:(s=function(n,r,e){var u={name:r.text,detail:"",kind:O[r.kind]||i.SymbolKind.Variable,range:o._textSpanToRange(t,r.spans[0]),selectionRange:o._textSpanToRange(t,r.spans[0]),tags:[],containerName:e};if(r.childItems&&r.childItems.length>0)for(var c=0,a=r.childItems;c<a.length;c++)s(n,a[c],u.name);n.push(u)},u=[],e.forEach((function(t){return s(u,t)})),[2,u])}}))}))},n}(p),I=function(){function t(){}return t.unknown="",t.keyword="keyword",t.script="script",t.module="module",t.class="class",t.interface="interface",t.type="type",t.enum="enum",t.variable="var",t.localVariable="local var",t.function="function",t.localFunction="local function",t.memberFunction="method",t.memberGetAccessor="getter",t.memberSetAccessor="setter",t.memberVariable="property",t.constructorImplementation="constructor",t.callSignature="call",t.indexSignature="index",t.constructSignature="construct",t.parameter="parameter",t.typeParameter="type parameter",t.primitiveType="primitive type",t.label="label",t.alias="alias",t.const="const",t.let="let",t.warning="warning",t}(),O=Object.create(null);O[I.module]=i.SymbolKind.Module,O[I.class]=i.SymbolKind.Class,O[I.enum]=i.SymbolKind.Enum,O[I.interface]=i.SymbolKind.Interface,O[I.memberFunction]=i.SymbolKind.Method,O[I.memberVariable]=i.SymbolKind.Property,O[I.memberGetAccessor]=i.SymbolKind.Property,O[I.memberSetAccessor]=i.SymbolKind.Property,O[I.variable]=i.SymbolKind.Variable,O[I.const]=i.SymbolKind.Variable,O[I.localVariable]=i.SymbolKind.Variable,O[I.variable]=i.SymbolKind.Variable,O[I.function]=i.SymbolKind.Function,O[I.localFunction]=i.SymbolKind.Function;var T,A,B=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return f(n,t),n._convertOptions=function(t){return{ConvertTabsToSpaces:t.insertSpaces,TabSize:t.tabSize,IndentSize:t.tabSize,IndentStyle:o.Smart,NewLineCharacter:"\n",InsertSpaceAfterCommaDelimiter:!0,InsertSpaceAfterSemicolonInForStatements:!0,InsertSpaceBeforeAndAfterBinaryOperators:!0,InsertSpaceAfterKeywordsInControlFlowStatements:!0,InsertSpaceAfterFunctionKeywordForAnonymousFunctions:!0,InsertSpaceAfterOpeningAndBeforeClosingNonemptyParenthesis:!1,InsertSpaceAfterOpeningAndBeforeClosingNonemptyBrackets:!1,InsertSpaceAfterOpeningAndBeforeClosingTemplateStringBraces:!1,PlaceOpenBraceOnNewLineForControlBlocks:!1,PlaceOpenBraceOnNewLineForFunctions:!1}},n.prototype._convertTextChanges=function(t,n){return{text:n.newText,range:this._textSpanToRange(t,n.span)}},n}(p),P=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return f(n,t),n.prototype.provideDocumentRangeFormattingEdits=function(t,n,r){return l(this,void 0,void 0,(function(){var e,i,s,u,o,c=this;return h(this,(function(a){switch(a.label){case 0:return e=t.uri,i=t.getOffsetAt({lineNumber:n.startLineNumber,column:n.startColumn}),s=t.getOffsetAt({lineNumber:n.endLineNumber,column:n.endColumn}),[4,this._worker(e)];case 1:return u=a.sent(),t.isDisposed()?[2]:[4,u.getFormattingEditsForRange(e.toString(),i,s,B._convertOptions(r))];case 2:return!(o=a.sent())||t.isDisposed()?[2]:[2,o.map((function(n){return c._convertTextChanges(t,n)}))]}}))}))},n}(B),L=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return f(n,t),Object.defineProperty(n.prototype,"autoFormatTriggerCharacters",{get:function(){return[";","}","\n"]},enumerable:!1,configurable:!0}),n.prototype.provideOnTypeFormattingEdits=function(t,n,r,e){return l(this,void 0,void 0,(function(){var i,s,u,o,c=this;return h(this,(function(a){switch(a.label){case 0:return i=t.uri,s=t.getOffsetAt(n),[4,this._worker(i)];case 1:return u=a.sent(),t.isDisposed()?[2]:[4,u.getFormattingEditsAfterKeystroke(i.toString(),s,r,B._convertOptions(e))];case 2:return!(o=a.sent())||t.isDisposed()?[2]:[2,o.map((function(n){return c._convertTextChanges(t,n)}))]}}))}))},n}(B),F=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return f(n,t),n.prototype.provideCodeActions=function(t,n,r){return l(this,void 0,void 0,(function(){var e,i,s,u,o,c,a,f=this;return h(this,(function(l){switch(l.label){case 0:return e=t.uri,i=t.getOffsetAt({lineNumber:n.startLineNumber,column:n.startColumn}),s=t.getOffsetAt({lineNumber:n.endLineNumber,column:n.endColumn}),u=B._convertOptions(t.getOptions()),o=r.markers.filter((function(t){return t.code})).map((function(t){return t.code})).map(Number),[4,this._worker(e)];case 1:return c=l.sent(),t.isDisposed()?[2]:[4,c.getCodeFixesAtPosition(e.toString(),i,s,o,u)];case 2:return!(a=l.sent())||t.isDisposed()?[2,{actions:[],dispose:function(){}}]:[2,{actions:a.filter((function(t){return 0===t.changes.filter((function(t){return t.isNewFile})).length})).map((function(n){return f._tsCodeFixActionToMonacoCodeAction(t,r,n)})),dispose:function(){}}]}}))}))},n.prototype._tsCodeFixActionToMonacoCodeAction=function(t,n,r){for(var e=[],i=0,s=r.changes;i<s.length;i++)for(var u=0,o=s[i].textChanges;u<o.length;u++){var c=o[u];e.push({resource:t.uri,edit:{range:this._textSpanToRange(t,c.span),text:c.newText}})}return{title:r.description,edit:{edits:e},diagnostics:n.markers,kind:"quickfix"}},n}(B),R=function(r){function e(){return null!==r&&r.apply(this,arguments)||this}return f(e,r),e.prototype.provideRenameEdits=function(r,e,i){return l(this,void 0,void 0,(function(){var s,u,o,c,a,f,l,d,v,b,p,m;return h(this,(function(h){switch(h.label){case 0:return u=(s=r.uri).toString(),o=r.getOffsetAt(e),[4,this._worker(s)];case 1:return c=h.sent(),r.isDisposed()?[2]:[4,c.getRenameInfo(u,o,{allowRenameOfImportPath:!1})];case 2:if(!1===(a=h.sent()).canRename)return[2,{edits:[],rejectReason:a.localizedErrorMessage}];if(void 0!==a.fileToRename)throw new Error("Renaming files is not supported.");return[4,c.findRenameLocations(u,o,!1,!1,!1)];case 3:if(!(f=h.sent())||r.isDisposed())return[2];for(l=[],d=0,v=f;d<v.length;d++){if(p=n.parse((b=v[d]).fileName),!(m=t.getModel(p)))throw new Error("Unknown URI "+p+".");l.push({resource:p,edit:{range:this._textSpanToRange(m,b.textSpan),text:i}})}return[2,{edits:l}]}}))}))},e}(p);function E(t){A=W(t,"typescript")}function _(t){T=W(t,"javascript")}function M(){return new Promise((function(t,n){if(!T)return n("JavaScript not registered!");t(T)}))}function U(){return new Promise((function(t,n){if(!A)return n("TypeScript not registered!");t(A)}))}function W(t,n){var r=new c(n,t),e=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return r.getLanguageServiceWorker.apply(r,t)},s=new m(e);return i.registerCompletionItemProvider(n,new g(e)),i.registerSignatureHelpProvider(n,new k(e)),i.registerHoverProvider(n,new j(e)),i.registerDocumentHighlightProvider(n,new S(e)),i.registerDefinitionProvider(n,new x(s,e)),i.registerReferenceProvider(n,new C(s,e)),i.registerDocumentSymbolProvider(n,new N(e)),i.registerDocumentRangeFormattingEditProvider(n,new P(e)),i.registerOnTypeFormattingEditProvider(n,new L(e)),i.registerCodeActionProvider(n,new F(e)),i.registerRenameProvider(n,new R(e)),new w(s,t,n,e),e}export{M as getJavaScriptWorker,U as getTypeScriptWorker,_ as setupJavaScript,E as setupTypeScript}